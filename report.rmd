---
output: html_document
editor_options: 
chunk_output_type: console
---
```{r}
library(tidyverse)
```

```{r}
data <- read.csv("uo_nn_batch_123456-789101.csv", sep = ";")
summary(data)
str(data)
```

```{r}
# New Column Method Name

data$Method <- "GM"
data$Method[data$isd == 3] <- "QNM"
data$Method[data$isd == 7] <- "SGM"
```

## Convergence

### Global

```{r}
# Lambda vs L*

boxplot_la_l_opt <- data %>%
    ggplot(aes(x = Method, y = L., color = factor(la))) +
    geom_boxplot() +
    geom_jitter(shape = 16, position = position_jitter(0.2)) +
    xlab("Lambda") +
    ylab("Optiaml L") +
    theme(
        legend.title = element_text(color = "blue", size = 10),
        legend.text = element_text(color = "red")
    )

boxplot_la_l_opt
```


```{r}
#average value of the loss function

table_d<- data %>%
  group_by(la,Method) %>% 
  summarize(mean_L = round(mean(L.),3))
table_d
```


```{r}
# Stacked Optimal L per lambda

l_opt_la_g_plot <- data %>%
    ggplot(aes(x = factor(la), y = L., fill = Method)) +
    geom_bar(stat = "identity")

l_opt_la_g_plot
```




### Local

```{r}
# Time Execution per Method

tex_g_plot <- data %>%
    ggplot(aes(x = num_target, y = tex, color = Method)) +
    geom_line() +
    facet_grid(~factor(la)) +
    scale_x_continuous(breaks = seq(0, 10, by = 1)) +
    scale_y_continuous(trans = "log10") +
    ylab("Time of Execution (s)") +
    xlab("Target Number")
tex_g_plot
```

```{r}
# Stacked Time Execution
    # ggplot(aes(x = num_target, y = tex, color = Method)) +
stck_tex_g_plot <- data %>%
    ggplot(aes(x = factor(num_target), y = niter, fill = factor(isd))) +
    geom_bar(stat = "identity") +
    scale_y_continuous(trans = "log10")
    # geom_line() +
    # facet_grid(~factor(la)) +
    # scale_x_continuous(breaks = seq(0, 10, by = 1)) +
    # ylab("Time of Execution (s)") +
    # xlab("Target Number")

stck_tex_g_plot
```



```{r}
# Iterations per Method for each target number

niter_g_plot <- data %>%
    ggplot(aes(x = num_target, y = niter, color = Method)) +
    geom_line() +
    scale_y_continuous(trans = "log2") +
    scale_x_continuous(breaks = seq(0, 10, by = 1)) +
    facet_grid(~factor(la))

niter_g_plot
```


```{r}
# Execution time per iterations 
boxplot_tpi <- data %>%
    ggplot(aes(x =  Method, y = tex/niter, color = Method)) +
    geom_boxplot() +
    xlab("Algorithm") +
    ylab("Execution time per iteration") 

boxplot_tpi
```



### Discussion

## Performance
### Large Problems
### Accuracy
```{r}
# Training accuracy per Method
tr_acc_g_plot <- data %>%
    ggplot(aes(x = Method, y = tr_acc, color = Method)) +
    geom_boxplot() +
    geom_jitter(shape = 16, position = position_jitter(0.2)) +
    facet_grid(~factor(la)) +
    scale_y_continuous(trans = "log10")

tr_acc_g_plot
```

```{r}
# Test accuracy per Method
te_acc_g_plot <- data %>%
    ggplot(aes(x = Method, y = te_acc, color = Method)) +
    geom_boxplot() +
    geom_jitter(shape = 16, position = position_jitter(0.2)) +
    facet_grid(~factor(la)) +
    scale_y_continuous(trans = "log10")

te_acc_g_plot
```
